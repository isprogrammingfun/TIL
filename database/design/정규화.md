## 정규화

### ****데이터베이스 정규화(Normalization) 란?****
관계형 데이터베이스의 설계에서 데이터의 일관성을 유지하고, 중복을 최소화하며, 최대한의 데이터 유연성을 얻기 위해 데이터를 구조화하는 프로세스를 정규화라고 한다. 정규화의 기본 목표는 관련이 없는 함수 종속성은 별개의 릴레이션으로 표현하는 것이다. 이 과정에서 불필요한 데이터를 제거하고 이에 따라 데이터 저장을 논리적으로 한다. 

### 정규화를 해야 하는 이유 (장점)
1. 불필요한 데이터를 제거 데이터의 중복을 최소화 
    - 만약 하나의 테이블에 모든 정보를 다 넣게 되면 불필요하게 중복되는 데이터가 저장될 수 있다. 그렇다면 불필요하게 더 많은 디스크 공간을 차지하게 될 수 있다. 따라서 테이블 간에 FK로 PK를 연결해 사용하면 디스크 공간을 훨씬 효율적으로 사용할 수 있다.
2. 데이터베이스 구조 확장 시 재디자인을 최소화
    - 정규화된 데이터베이스 구조에서는 테이블에 새로운 데이터 형의 추가로 인한 확장시, 그 구조를 변경하지 않아도 되거나 일부만 변경해도 된다.
3. 다양한 관점에서의 query를 지원
    - JOIN을 통해 원하는 정보를 가져올 수 있다.
4. 무결성 제약조건의 시행을 간단하게 하기 위해 
    - 데이터의 정확성, 일관성, 유효성이 유지된다.
    - 데이터의 무결성을 유지하는 것은 데이터베이스 관리시스템의(DBMS)의 중요한 기능이며, 주로 데이터에 적용되는 연산에 제한을 두어 데이터의 무결성을 유지하게 된다.
5. 각종 이상 현상 (Anomaly)을 방지
    - 삭제 이상
        - 튜플 삭제 시 연쇄 삭제가 발생하는 현상이다.
    - 삽입 이상
        - 튜플 삽입 시 저장하지 않은 속성값이 NULL을 갖거나, 원하지 않는 자료가 삽입되는 현상이다.
    - 갱신 이상
        - 데이터 갱신 시 일관성 유지가 안되는 현상이다.

### 정규화 단점
1. 릴레이션의 분해로 인해 릴레이션 간의 JOIN 연산이 많아진다. 
2. 질의에 대한 응답 시간이 느려질 수도 있다. 

### 제 1정규형 (1NF) 부분적 함수 종속 제거
1. 각 칼럼이 하나의 속성만을 가져야 한다. 즉 테이블의 칼럼이 원자값을 갖도록 테이블을 분해하는 것이다. 
2. 하나의 칼럼은 같은 종류나 타입의 값을 가져야 한다.
3. 각 칼럼이 유일한 이름을 가져야 한다.
4. 칼럼의 순서가 상관없어야 한다. 

### 제 2정규형 (2NF) 부분적 함수 종속 제거
1. 제 1정규형을 만족해야 한다.
2. 모든 칼럼이 부분적 종속이 없어야 한다. 즉 모든 칼럼이 완전 함수 종속을 만족해야 한다.  부분적 종속이란 기본 키 중에 특정 컬럼에만 종속되는 것이다. 완전 함수 종속이란 기본 키의 부분집합이 결정자가 되어선 안된다는 것이다. 
    - 예를 들어 학생 번호, 과목, 지도 교수, 성적 총 4가지 칼럼을 가지고 있는 테이블이 있다고 하자. 이때 성적의 특정 값을 알기 위해서는 학생 번호와 과목이 필요하다. 그러나 지도 교수는 과목명만 알아도 알 수 있다. 해당 테이블에서 기본 키는 학생 번호와 과목으로 복합 키인데, 지도 교수는 학생 번호, 과목 모두에 종속되는 것이 아니라 과목에만 종속되는 부분적 종속으로 제 2정규형을 만족하지 않는다. 따라서 학생 번호, 과목, 성적으로 이루어진 테이블과 과목, 지도 교수로 이루어진 테이블 총 두 가지로 나누어야 한다.

### 제 3 정규형 (3NF) 이행적 함수 종속 제거
1. 제 2정규형을 만족해야 한다.
2. 기본키를 제외한 속성들 간의 이행 종속성이 없어야 한다. 
    - 이행 종속성이란 A → B, B → C 일 때, A → C 가 성립하면 이행 종속이라고 한다.

### BCNF (Boyce-Codd Normal Form) 정규형
1. 제 3정규형을 만족해야 한다.
2. 모든 결정자가 후보키 집합에 속해야 한다. 모든 결정자가 후보키 집합에 속해야 한다는 뜻은, 후보키 집합에 없는 칼럼이 결정자가 되어서는 안 된다는 뜻이다. 
    - 예를 들어 학생 번호, 과목, 지도교수 총 3가지 칼럼을 가지고 있는 테이블이 있다고 하자. 학생 번호, 과목이 기본 키로 지도 교수를 알 수 있는데, 같은 과목을 다른 교수가 가르칠 수도 있어서 과목 → 지도교수 종속은 성립하지 않는다. 하지만 지도교수가 어떤 과목을 가르치는지 알 수 있으므로 지도교수 → 과목 종속이 성립한다. 이처럼 후보키 집합이 아닌 칼럼이 결정자가 되어버린다면 BCNF를 만족하지 않는다.

### 고급 정규형 (제 4정규형, 제 5정규형)
- 제 4정규형
    - 릴레이션이 BCNF를 만족하면서, 함수 종속이 아닌 다치 종속을 제거해야 만족할 수 있다.
- 제 5정규형
    - 릴레이션이 제 4정규형을 만족하면서 후보키를 통하지 않는 조인 종속을 제거해야 만족할 수 있다.
- 보통 정규화는 BCNF 까지만 하는 경우가 많다. 그 이상 정규화를 하면 정규화의 단점이 나타날 수도 있다.

### 반정규화
- 반정규화는 정규화된 엔티티, 속성, 관계를 시스템의 성능 향상 및 개발과 운영의 단순화를 위해 중복 통합, 분리 등을 수행하는 데이터 모델링 기법 중 하나이다.
- 언제 사용하는가?
    - 디스트 I/O 량이 많아서 조회 시 성능이 저하될 때
    - 테이블끼리의 경로가 너무 멀어 조인으로 인한 성능 저하가 예상될 때
    - 칼럼을 계산하여 조회할 때 성능이 저하될 것이 예상될 때
    - 일반적으로 조회에 대한 처리 성능이 중요하다고 판단될 때
- 무엇이 반정규화의 대상이 되는가?
    - 자주 사용되는 테이블에 액세스하는 프로세스의 수가 가장 많은 경우
    - 항상 일정한 범위만을 조회하는 경우
    - 테이블에 대량 데이터가 있고 대량의 범위를 자주 처리하는 경우
    - 성능 상 이슈가 있을 경우
    - 테이블에 지나치게 조인을 많이 사용하게 되어 데이터를 조회하는 것이 기술적으로 어려울 경우
- 반정규화 과정에서 주의할 점은?
    - 반정규화를 과도하게 적용하다 보면 데이터의 무결성이 깨질 수 있다.
    - 또한 입력, 수정, 삭제의 질의문에 대한 응답 시간이 늦어질 수 있다.

### 참고자료
[https://velog.io/@bsjp400/Database-DB-정규화-비정규화란](https://velog.io/@bsjp400/Database-DB-%EC%A0%95%EA%B7%9C%ED%99%94-%EB%B9%84%EC%A0%95%EA%B7%9C%ED%99%94%EB%9E%80) 

[https://code-lab1.tistory.com/48](https://code-lab1.tistory.com/48)