## 트랜잭션

### 트랜잭션이란?

---

데이터베이스의 상태를 변화시키기 위해서 수행하는 작업의 단위. 데이터베이스의 상태를 변화시킨다는 것은 SELECT, UPDATE, INSERT, DELETE 와 같은 SQL을 이용해 데이터베이스에 접근하는 것을 의미한다. 작업의 단위는 질의어 한 문장이 아니다. 작업 단위는 많은 질의어 명령문들을 사람이 정하는 기준에 따라 정하는 것이다. 예를 들어 어떤 게시판에 새로운 글을 올리기 버튼을 통해 올린 후, 다시 게시판으로 돌아왔을 때 업데이트된 상태를 보고 싶으면 올리기 버튼을 눌렀을 때 Insert 문을 사용하고, 그 후에, 게시판을 구성할 데이터를 다시 Select 하여 최신 정보로 유지한다. 여기서 작업의 단위는 Insert, Select문 둘 다 합친 것이다. 관리자나 개발자가 하나의 트랜잭션 설계를 잘하는 것이 데이터를 다루는 것에 많은 이점이 있다. 

### 트랜잭션의 특징

---

1. 원자성 (Atomicity)
    - 트랜잭션의 연산은 데이터베이스에 모두 반영되던가, 아니면 전혀 반영되지 않아야 한다.
    - 트랜잭션 내의 모든 명령은 반드시 완벽히 수행되어야 하며, 모두가 완벽히 수행되지 않고 어느 하나라도 오류가 발생하면 트랜잭션 전부가 취소되어야 한다.
2. 일관성 (Consistency)
    - 트랜잭션 작업 처리의 결과가 항상 일관되어야 한다.
    - 시스템이 가지고 있는 고정요소는 트랜잭션 수행 전과 트랜잭션 수행 완료 후의 상태가 같아야 한다.
    - 트랜잭션이 진행되는 동안에 데이터베이스가 변경 되더라도 업데이트 된 데이터베이스로 트랜잭션이 진행되는 것이 아니라, 처음에 트랜잭션을 진행 하기 위해 참조한 데이터베이스로 진행된다.
3. 독립성 (Isolation)
    - 트랜잭션이 동시에 실행되고 있을 경우 어떤 하나의 트랜잭션이라도, 다른 트랜잭션의 연산에 끼어들 수 없다.
    - 수행중인 트랜잭션은 완전히 완료될 때까지 다른 트랜잭션에서 수행 결과를 참조할 수 없다.
4. 지속성 (Durability)
    - 성공적으로 완료된 트랜잭션의 결과는 시스템이 고장나더라도 영구적으로 반영되어야 한다.

### 트랜잭션 연산 및 상태

---

1. Commit 연산
    - 한개의 논리적 단위(트랜잭션)에 대한 작업이 성공적으로 끝났고 데이터베이스가 다시 일관된 상태에 있을 때, 이 트랜잭션이 행한 갱신 연산이 완료된 것을 트랜잭션 관리자에게 알려주는 연산이다.
    - 이 연산을 사용하면 수행했던 트랜잭션이 로그에 저장되며, 후에 Rollback 연산을 수행했었던 트랜잭션 단위로 하는 것을 도와준다.
2. Rollback 연산
    - 하나의 트랜잭션 처리가 비정상적으로 종료되어 데이터베이스의 일관성을 깨뜨렸을 때, 이 트랜잭션의 일부가 정상적으로 처리되었더라도 트랜잭션의 원자성을 구현하기 위해 이 트랜잭션이 행한 모든 연산을 취소하는 연산이다.
    - Rollback시에는 해당 트랜잭션을 재시작하거나 폐기한다.
3. 트랜잭션의 상태

![다운로드 (5)](https://user-images.githubusercontent.com/78543382/218320715-d81174bf-a711-49ea-859a-53612f8ee573.png)


1) 활동 (Active) : 트랜잭션이 실행중인 상태

2) 실패 (Failed) : 트랜잭션 실행에 오류가 발생하여 중단된 상태

3) 철회 (Aborted) : 트랜잭션이 비정상적으로 종료되어 Rollback 연산을 수행한 상태

4) 부분 완료 (Partially Committed) : 트랜잭션의 마지막 연산까지 실행했지만, Commit 연산이 실행되기 직전의 상태

5) 완료 (Committed) : 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태
### 참고자료

---

[https://mommoo.tistory.com/62](https://mommoo.tistory.com/62)

[https://coding-factory.tistory.com/226](https://coding-factory.tistory.com/226)

[https://wonit.tistory.com/462](https://wonit.tistory.com/462)