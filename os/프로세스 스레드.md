## 프로세스, 스레드

### 프로그램 → 프로세스 → 스레드

---

**프로그램이란?**

- 파일이 저장 장치에 저장되어 있지만 **메모리에는 올라가 있지 않은 정적인 상태**. 즉 아직 실행되지 않은 파일 그 자체이다.
    - 메모리에 올라가 있지 않은: 아직 운영체제가 프로그램에게 독립적인 메모리 공간을 할당해주지 않았다는 뜻이다. 모든 프로그램은 운영체제가 실행되기 위한 메모리 공간을 할당해 줘야 실행될 수 있다.
    - 정적인 상태: 실행되지 않고 가만히 있는 상태
- 윈도우의 *.exe 파일이나 MacOs의 *.dmg 파일 같은 사용자가 눌러서 실행하기 전의 파일이다.

**프로세스**

- 프로그램을 실행하는 순간 해당 파일은 컴퓨터 메모리에 올라가게 되고, 이 상태를 **동적인 상태** 라고 하며 이 상태의 프로그램을 **프로세스**라고 한다. 즉 작업중인 프로그램이다.
- 운영체제로부터 시스템 자원을 할당받는 작업의 단위이다.  할당받는 시스템 자원의 예로는
    - CPU 시간
    - 운영되기 위해 필요한 주소 공간
    - Code, Data, Stack, Heap의 구조로 되어있는 독립된 메모리 영역
- 각 프로세스는 별도의 주소 공간에서 실행되며, 한 프로세스는 다른 프로세스의 변수나 자료구조에 접근할 수 없다.
- 운영체제 관점에서 최소 작업 단위이다.

![images_raejoonee_post_467686bc-b53e-44d7-a0ac-6bd0372f1714_101](https://user-images.githubusercontent.com/78543382/216809442-9b26f2ab-ebdb-41b0-b446-4a43a0aacd06.png)
**스레드**

- 프로그램이 복잡해질수록 프로세스 하나만을 사용하여 프로그램을 실행하기에는 어렵다. 한 프로그램을 처리하기 위해 프로세스를 여러 개 만들 수는 없다. 운영체제는 안정성을 위해 프로세스마다 자신에게 할당된 메모리 내의 정보에만 접근할 수 있도록 제약을 두고 있고, 이를 벗어나는 정보에 접근하려면 오류가 발생하기 때문이다. 이를 해결하기 위해 나타난 개념이 스레드이다.
- 스레드는 프로세스와 다르게 스레드 간 메모리를 공유하며 작동한다. 스레드끼리 프로세스의 자원을 공유하면서 프로세스 실행 흐름의 일부가 되는 것이다. 즉, 프로세스의 특정한 수행 경로이다. 프로그램이 코드 덩어리라면 스레드는 코드 내에 선언된 함수들이다.
- 스레드는 프로세스 내에서 각각 Stack만 따로 할당 받고, Code, Data, Heap 영역은 공유한다. 반면에 프로세스는 다른 프로세스의 메모리에 직접 접근할 수 없다.
- 한 스레드가 프로세스 자원을 변경하면, 다른 이웃 스레드(sibling thread)도 그 변경 결과를 즉시 볼 수 있다.
- CPU 관점에서 최소 작업 단위이다.

### 프로세스와 스레드의 작동 방식

---

![images_raejoonee_post_b7939911-f3e8-48ac-abb8-63d8a17d0444_103](https://user-images.githubusercontent.com/78543382/216809463-af00f92a-dc4f-49c8-aa7b-cb15c0070640.png)

![images_raejoonee_post_b91490ed-c67b-407d-8fea-a8d6fdb22559_104](https://user-images.githubusercontent.com/78543382/216809462-a2c2ea70-961d-4c5c-84e4-41e63cf45eeb.png)

- 위에서 말했듯이 운영체제는 프로세스마다 각각 독립된 메모리 영역을 Code, Data, Stack, Heap의 형태로 할당해 주고, 각각 독립된 메모리 영역을 할당해 주기 때문에 프로세스는 다른 프로세스의 변수나 자료에 접근이 불가능하다.
    - 프로세스가 다른 프로세스의 정보에 접근이 아예 불가능한 것은 아니다. IPC, LPC를 사용하거나 별도로 공유 메모리를 만들어 정보를 주고 받도록 설정해주면 되지만, 단순 CPU 레지스터 교체뿐만이 아니라 RAM과 CPU 사이의 캐시 메모리까지 초기화되기 때문에 자원부담이 크다.
- 스레드는 메모리를 서로 공유할 수 있다. 프로세스가 할당받은 메모리 영역 내에서 Stack 형식으로 할당된 메모리 영역은 따로 할당받고, 나머지 Code, Data, Heap 형식으로 할당된 메모리 영역을 공유한다. 따라서 각각의 스레드는 별도의 스택을 가지고 있지만 힙 메모리는 서로 읽고 쓸 수 있게 된다.

**만약 한 프로세스를 실행하다가 오류가 발생해 프로세스가 강제로 종료된다면, 다른 프로세스에게 영향이 있을까? → 공유하고 있는 파일을 손상시키는 경우가 아니라면 아무런 영향을 주지 않는다**

**스레드는? → 스레드는 Code, Data, Heap 메모리 영역의 내용을 공유하고 있기 때문에 어떤 스레드 하나에서 오류가 발생한다면 같은 프로세스 내의 다른 스레드 모두가 강제로 종료된다.** 

### 참고자료

---

[https://velog.io/@raejoonee/프로세스와-스레드의-차이](https://velog.io/@raejoonee/%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EC%99%80-%EC%8A%A4%EB%A0%88%EB%93%9C%EC%9D%98-%EC%B0%A8%EC%9D%B4) 

[https://gmlwjd9405.github.io/2018/09/14/process-vs-thread.html](https://gmlwjd9405.github.io/2018/09/14/process-vs-thread.html)